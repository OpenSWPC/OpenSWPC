# スナップショット

## `read_snp.x` 

スナップショットは独自形式もしくは`NetCDF`形式のバイナリファイルであるが，いずれもプログラム`read_snp.x`によって可視化もしくは振幅データの抽出ができる．


``` bash
read_snp.x -i snapshotfile [-h] [-ppm|-bmp] [-pall] 
              [-mul var | -mul1 var -mul2 var ...] [-bin] [-asc] [-skip n]
```

  `-h`
  : スナップショットファイルに内包されているヘッダ情報を出力する．計算を実施した日時・計算タイトル・コード種別（3D/PSV/SH）・グリッド間隔・座標系などの情報が出力される．以下に例を示す．

    ``` txt
     $ ../bin/read_snp.x -i swpc_3d.xz.ps.snp -h

     [binary type]   : STREAMIO
     [code type]     : SWPC_3D
     [header version]:          3
     [title]         : swpc_3d
     [date generated]: 1408015126
                       2014-08-14T11-18-46
     [coordinate]    : xz
     [data type]     : ps
     [ns1]           :        256
     [ns2]           :        256
     [beg1]          :       -63.87500
     [beg2]          :        -9.87500
     [ds1]           :         0.25000
     [ds2]           :         0.25000
     [dt]            :         0.05000
     [na1]           :         20
     [na2]           :         20
     [nmed]          :          3
     [nsnp]          :          2
     [clon]          :       143.50000
     [clat]          :        42.00000
    ```

  `-ppm`, `-bmp`
  : それぞれppmもしくはbmp形式の画像を出力する．結果はそれぞれ`ppm`/`bmp`ディレクトリ（自動作成）に連番ファイルとして格納される．可視化対象が速度あるいは変位であれば，上下動と水平動をそれぞれ赤と緑で，P波・S波（div, rot）であればそれぞれの成分の絶対値を赤と緑で色分けして表示する．ただし，絶対値オプションが付加された場合にはGMTのカラーパレットhot相当の色で絶対値を可視化する．

!!! bug "BMP形式の制限"
      `bmp` は仕様により画素数によってうまく動かないことがある．`ppm`形式を推奨する．
      
  `-pall`
  : 吸収境界領域まで含めて可視化を行う（デフォルトでは切り落とす）

  `-mul`
  : 可視化する際に出力振幅をvar倍する．色の強さの調整をここで行う．`-mul1`, `-mul2`などを用いると，成分ごとの振幅の重みを個別に与えることができる．これにより，たとえばP波だけあるいは上下動だけというように，特定成分だけを切り出すことができる．

  `-abs`
  : 速度スナップショットに対してその絶対値を可視化する．P波・S波のスナップショットはもともとそれぞれの絶対値が出力されているので動作しない．

  `-bin`, `-asc`
  : 各時間ステップのスナップショットを単精度バイナリもしくはアスキーデータとしてbinもしくはascディレクトリに出力する．バイナリデータは`GMT`(`xyz2grd`など）から-bisオプションで直接読み込むことができる．

  `-skip n`
  : 最初の$n$スナップショットを読み飛ばす．


## `diff_snp.x`

ふたつのスナップショットファイルの差を取り，同じフォーマットのスナップショットファイルに出力する．

``` bash
$ diff_snp.x snap1 snap2 diffile
```

出力ファイルのフォーマット（`NetCDF`もしくは独自バイナリ）は入力ファイルのフォーマットに依存する．
